<!DOCTYPE html>
<?php 
if(!isset($_POST['submit' ] ) ) {
	echo '<form action="upload.php" method="post" enctype="multipart/form-data">
    		Select gz to upload:
    		<input type="file" name="uploaded" id="fileToUpload">
    		<input type="submit" value="Upload Image" name="submit">
	      </form>';
}
if(isset($_POST[ 'submit' ])) { 
    // File information 
    $uploaded_name = $_FILES[ 'uploaded' ][ 'name' ]; 
    $uploaded_ext  = substr( $uploaded_name, strrpos( $uploaded_name, '.' ) + 1); 
    $uploaded_size = $_FILES[ 'uploaded' ][ 'size' ]; 
    $uploaded_type = $_FILES[ 'uploaded' ][ 'type' ]; 
    $uploaded_tmp  = $_FILES[ 'uploaded' ][ 'tmp_name' ]; 
    if($uploaded_ext != "gz")
    {
	    echo "Please upload gz file";
	    exit();
    }

    // Where are we going to be writing to? 
    $target_path   = '/var/www/html/uploads/'; 
    #$random_name   = rand(0,100);
    #$target_file   = $random_name . '.' . md5( uniqid() . $uploaded_name ) . '.' . $uploaded_ext; 
    $target_file = $uploaded_name;
    $temp_file     = "/tmp".DIRECTORY_SEPARATOR.$target_file; 

    if(move_uploaded_file($uploaded_tmp, $target_path.urldecode($target_file))) {
	echo "The file: ". basename( $_FILES["uploaded"]["name"]). " has been uploaded.<br>";
	echo "The uploaded path: ". $target_path . urldecode($target_file) ."<br><br>";
	$sys=shell_exec('zgrep pwned /var/www/html/uploads/*');
	echo "The output is: ". $sys . "<br>";

    } else {
	echo "<pre>Your file was not uploaded.</pre>";
    }
} 
?>
