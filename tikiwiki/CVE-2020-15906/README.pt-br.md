# Tiki Wiki CMS Groupware 21.1 Authentication Bypass (CVE-2020-15906)

Tiki Wiki CMS Groupware ou simplesmente Tiki, originalmente conhecido como TikiWiki, é um sistema de gerenciamento de conteúdo baseado em Wiki livre e de código aberto e suíte de escritório online escrito principalmente em PHP e distribuído sob a licença GNU Lesser General Public License (LGPL).

Há uma nova vulnerabilidade no TikiWiki Cms Groupware 16.x - 21.1. Ele permite que invasores remotos não autenticados ignorem a página de login, o que resulta em um comprometimento total do Tiki Wiki CMS. Um invasor pode forçar a conta de administrador com força bruta até que ela seja bloqueada. Depois disso, uma senha vazia pode ser usada para autenticar como administrador para obter acesso.

Referências:

- https://info.tiki.org/article473-Security-Releases-of-all-Tiki-versions-since-16-3
- https://github.com/S1lkys/CVE-2020-15906
- http://packetstormsecurity.com/files/159663/Tiki-Wiki-CMS-Groupware-21.1-Authentication-Bypass.html
- https://srcincite.io/pocs/cve-2021-26119.py.txt

## Ambiente vulnerável

Execute os seguintes comandos para iniciar um Tiki Wiki CMS 21.1:

```
docker-compose up -d
```

Depois que o servidor estiver rodando, navegue até `http://your-ip:8080` para ver a página de boas-vindas.

## Explorando

[POC](https://srcincite.io/pocs/cve-2021-26119.py.txt) combina dois bugs que levam à execução remota de código:

Bug 1: CVE-2020-15906 - Um usuário não autenticado pode ignorar a autenticação forçando a conta de administrador > 50 vezes e fazer login com uma senha em branco - Funciona em: <= 21.1 (UY_Scuti)

Bug 2: CVE-2021-26119 - Um usuário administrador pode acionar uma injeção de modelo no servidor e obter execução remota de código escapando da sandbox do Smarty Template Engine aproveitando a propriedade 'template_object' - Funciona em: <= 22.2 (Corona_Borealis) e impacta Smarty <= 3.1.38 (mais recente)

```shell
python poc.py your-ip:8080 / id
```

![](1.png)

_WARNING_ Este exploit bloqueará a conta de administrador.
